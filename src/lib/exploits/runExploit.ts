/*
 * SPDX-FileCopyrightText: 2025 cod3ddo@proton.me
 *
 * SPDX-License-Identifier: AGPL-3.0-or-later
 */

import type { IExploit, IExploitResponse } from "./interfaces";

export const runExploit = async (
	exploit: IExploit,
	tabId: number,
): Promise<IExploitResponse> => {
	const result = await chrome.runtime.sendMessage({
		cmd: "inject",
		location: exploit.location,
		tabId: tabId,
	});
	try {
		return {
			success: result[0],
			message: result[1],
		} as IExploitResponse;
	} catch {
		return {
			success: false,
			message: "Failed converting result from exploit",
		} as IExploitResponse;
	}
};
